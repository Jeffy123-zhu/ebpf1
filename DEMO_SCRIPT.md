# eBPF Time Machine - æ¼”ç¤ºè§†é¢‘è„šæœ¬

**æ€»æ—¶é•¿**: 5 åˆ†é’Ÿ
**ç›®æ ‡è§‚ä¼—**: å¼€å‘è€…ã€è¯„å§”ã€æŠ€æœ¯çˆ±å¥½è€…

---

## ðŸŽ¬ åœºæ™¯ 1: å¼€åœº (0:00 - 0:30)

### ç”»é¢
- æ˜¾ç¤ºé¡¹ç›® logo å’Œæ ‡é¢˜
- åŠ¨ç”»æ•ˆæžœï¼šæ—¶é’Ÿå€’è½¬

### æ—ç™½
```
å¤§å®¶å¥½ï¼ä»Šå¤©æˆ‘è¦å±•ç¤ºä¸€ä¸ªåˆ›æ–°çš„è°ƒè¯•å·¥å…· - eBPF Time Machineã€‚

ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µï¼š
ç¨‹åºçªç„¶å´©æºƒï¼Œä½†ä½ ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Ÿ
æƒ³è¦å›žåˆ°å´©æºƒå‰çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

eBPF Time Machine å°±æ˜¯ä¸ºæ­¤è€Œç”Ÿçš„æ—¶å…‰æœºå™¨ï¼
```

### å­—å¹•
- "eBPF Time Machine"
- "æ—¶é—´æ—…è¡Œå¼è°ƒè¯•"
- "è®©è°ƒè¯•åƒæ—¶é—´æ—…è¡Œä¸€æ ·ç®€å•"

---

## ðŸŽ¬ åœºæ™¯ 2: é—®é¢˜æ¼”ç¤º (0:30 - 1:00)

### ç”»é¢
- ç»ˆç«¯çª—å£
- è¿è¡Œä¸€ä¸ªä¼šå´©æºƒçš„ç¨‹åº

### æ“ä½œ
```bash
$ ./crash_demo
PID: 12345
Starting request processing...
[Processing request #1]
[Processing request #2]
...
[Processing request #42]
Segmentation fault (core dumped)
```

### æ—ç™½
```
è¿™æ˜¯ä¸€ä¸ªå…¸åž‹çš„åœºæ™¯ï¼šç¨‹åºåœ¨å¤„ç†ç¬¬ 42 ä¸ªè¯·æ±‚æ—¶å´©æºƒäº†ã€‚

ä¼ ç»Ÿçš„è°ƒè¯•æ–¹æ³•ï¼š
- æŸ¥çœ‹ core dumpï¼Ÿä¿¡æ¯æœ‰é™
- é‡æ–°è¿è¡ŒåŠ æ–­ç‚¹ï¼Ÿå¯èƒ½æ— æ³•é‡çŽ°
- æ·»åŠ æ—¥å¿—ï¼Ÿéœ€è¦ä¿®æ”¹ä»£ç é‡æ–°ç¼–è¯‘

æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Ÿ
```

### å­—å¹•
- "ä¼ ç»Ÿè°ƒè¯•çš„å›°å¢ƒ"
- "ä¿¡æ¯ä¸è¶³"
- "éš¾ä»¥é‡çŽ°"

---

## ðŸŽ¬ åœºæ™¯ 3: Time Machine ç™»åœº (1:00 - 2:30)

### ç”»é¢
- åˆ†å±ï¼šå·¦è¾¹è¿è¡Œç¨‹åºï¼Œå³è¾¹è¿è¡Œ Time Machine

### æ“ä½œ
```bash
# å·¦ä¾§ç»ˆç«¯
$ ./crash_demo &
PID: 12345

# å³ä¾§ç»ˆç«¯
$ sudo ./timemachine record 12345

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          â°  eBPF Time Machine v1.0              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Recording PID 12345
Press Ctrl+C to stop

Recording...
[1000 events] 0.2 MB
[2000 events] 0.4 MB
[3000 events] 0.6 MB

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸš¨ CRASH DETECTED!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Timestamp: 1234567890123456
Signal: SIGSEGV
PID: 12345

Use rewind:
  ./timemachine rewind 1234567890123456
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### æ—ç™½
```
çŽ°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨ eBPF Time Machineï¼

åªéœ€è¦ä¸¤ä¸ªç®€å•çš„å‘½ä»¤ï¼š
1. è¿è¡Œä½ çš„ç¨‹åº
2. å¯åŠ¨ Time Machine è¿½è¸ª

Time Machine ä½¿ç”¨ eBPF æŠ€æœ¯ï¼Œåœ¨å†…æ ¸æ€é«˜æ•ˆåœ°æ•èŽ·æ‰€æœ‰å…³é”®äº‹ä»¶ï¼š
- å‡½æ•°è°ƒç”¨
- å†…å­˜åˆ†é…å’Œé‡Šæ”¾
- ç³»ç»Ÿè°ƒç”¨
- æ–‡ä»¶æ“ä½œ

å½“ç¨‹åºå´©æºƒæ—¶ï¼ŒTime Machine è‡ªåŠ¨æ£€æµ‹å¹¶è®°å½•å´©æºƒä¿¡æ¯ã€‚
```

### å­—å¹•
- "é›¶é…ç½®å¯åŠ¨"
- "è‡ªåŠ¨è¿½è¸ªæ‰€æœ‰äº‹ä»¶"
- "è‡ªåŠ¨æ£€æµ‹å´©æºƒ"

---

## ðŸŽ¬ åœºæ™¯ 4: æ—¶é—´å€’å¸¦ (2:30 - 3:30)

### ç”»é¢
- æ‰§è¡Œ rewind å‘½ä»¤
- é«˜äº®æ˜¾ç¤ºå…³é”®äº‹ä»¶

### æ“ä½œ
```bash
$ sudo ./timemachine rewind 1234567890123456

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â° REWINDING to 1234567890123456
   Showing [-5s to +5s]
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Timestamp            PID      Type         Address            Details
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    1234567885000000 12345    FUNC_ENTRY   process_request    args=42
    1234567886000000 12345    ALLOC        0x7f1234567890     size=1024
    1234567887000000 12345    FUNC_ENTRY   snprintf           args=...
    1234567888000000 12345    FREE         0x7f1234567890     (freed)  â† è¿™é‡Œï¼
    1234567889000000 12345    FUNC_ENTRY   printf             args=...
>>> 1234567890123456 12345    ðŸ’¥CRASH      SIGSEGV            sig=11   â† å´©æºƒï¼

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸ” MEMORY ANALYSIS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Total allocations: 42
Total frees: 42
Potentially leaked: 0

âœ… No obvious leaks
```

### æ—ç™½
```
çŽ°åœ¨æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼

ä½¿ç”¨ rewind å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥"å€’å¸¦"åˆ°å´©æºƒå‰çš„ä»»æ„æ—¶åˆ»ã€‚

Time Machine æ˜¾ç¤ºäº†å´©æºƒå‰åŽ 5 ç§’å†…çš„æ‰€æœ‰äº‹ä»¶ã€‚

çœ‹ï¼é—®é¢˜ä¸€ç›®äº†ç„¶ï¼š
1. ç¨‹åºåˆ†é…äº†å†…å­˜ï¼ˆåœ°å€ 0x7f1234567890ï¼‰
2. ç„¶åŽé‡Šæ”¾äº†è¿™å—å†…å­˜
3. ä½†ä¹‹åŽåˆå°è¯•è®¿é—®è¿™å—å·²é‡Šæ”¾çš„å†…å­˜
4. å¯¼è‡´ Segmentation Fault

è¿™æ˜¯ä¸€ä¸ªå…¸åž‹çš„ Use-After-Free bugï¼

Time Machine è¿˜è‡ªåŠ¨åˆ†æžäº†å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œ
ç¡®è®¤æ²¡æœ‰å†…å­˜æ³„æ¼ã€‚
```

### å­—å¹•
- "æ—¶é—´å€’å¸¦"
- "å®Œæ•´çš„äº‹ä»¶åŽ†å²"
- "Use-After-Free æ£€æµ‹"
- "è‡ªåŠ¨å†…å­˜åˆ†æž"

---

## ðŸŽ¬ åœºæ™¯ 5: æŠ€æœ¯è§£æž (3:30 - 4:30)

### ç”»é¢
- ä»£ç ç¼–è¾‘å™¨æ˜¾ç¤º eBPF ä»£ç 
- æž¶æž„å›¾

### å±•ç¤ºä»£ç ç‰‡æ®µ
```c
// tracer.bpf.c - eBPF ç¨‹åº
SEC("uprobe/malloc")
int trace_malloc_enter(struct pt_regs *ctx) {
    if (!should_trace())
        return 0;
    
    struct event_data *evt = get_event_buf();
    fill_common_fields(evt, EVENT_ALLOC);
    evt->data.mem.size = PT_REGS_PARM1(ctx);
    
    submit_event(evt);
    return 0;
}
```

### æž¶æž„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         User Space                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Time Machine                    â”‚  â”‚
â”‚  â”‚  - Event collection              â”‚  â”‚
â”‚  â”‚  - Analysis                      â”‚  â”‚
â”‚  â”‚  - Time travel                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â†• Ring Buffer              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Kernel Space (eBPF)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  - Function probes               â”‚  â”‚
â”‚  â”‚  - Memory tracking               â”‚  â”‚
â”‚  â”‚  - Signal handling               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ—ç™½
```
è®©æˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹æŠ€æœ¯å®žçŽ°ã€‚

Time Machine ä½¿ç”¨äº†å¤šé¡¹ eBPF æŠ€æœ¯ï¼š

1. Uprobe/Uretprobe - è¿½è¸ªç”¨æˆ·æ€å‡½æ•°
2. Tracepoint - æ•èŽ·ç³»ç»Ÿäº‹ä»¶
3. Ring Buffer - é«˜æ•ˆçš„æ•°æ®ä¼ è¾“
4. BPF Maps - çŠ¶æ€ç®¡ç†

eBPF ç¨‹åºè¿è¡Œåœ¨å†…æ ¸æ€ï¼Œå¼€é”€æžä½Žï¼š
- äº‹ä»¶æ•èŽ·é€Ÿåº¦ï¼š> 100,000 events/sec
- CPU å¼€é”€ï¼š< 5%
- å»¶è¿Ÿï¼š< 1 å¾®ç§’

è¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ç”Ÿäº§çŽ¯å¢ƒä½¿ç”¨å®ƒï¼Œ
è€Œä¸ç”¨æ‹…å¿ƒæ€§èƒ½é—®é¢˜ã€‚
```

### å­—å¹•
- "eBPF å†…æ ¸ç¼–ç¨‹"
- "é«˜æ€§èƒ½è¿½è¸ª"
- "ç”Ÿäº§çŽ¯å¢ƒå¯ç”¨"

---

## ðŸŽ¬ åœºæ™¯ 6: åº”ç”¨åœºæ™¯ (4:30 - 4:50)

### ç”»é¢
- å¿«é€Ÿåˆ‡æ¢å¤šä¸ªåº”ç”¨åœºæ™¯

### åœºæ™¯åˆ—è¡¨
1. **Use-After-Free æ£€æµ‹**
   - æ˜¾ç¤ºå†…å­˜è¢«é‡Šæ”¾åŽè®¿é—®

2. **å†…å­˜æ³„æ¼åˆ†æž**
   - æ˜¾ç¤ºæœªé‡Šæ”¾çš„å†…å­˜ç»Ÿè®¡

3. **æ€§èƒ½åˆ†æž**
   - æ˜¾ç¤ºå‡½æ•°è°ƒç”¨æ—¶é—´

4. **ç”Ÿäº§çŽ¯å¢ƒè°ƒè¯•**
   - æ˜¾ç¤ºçœŸå®žåº”ç”¨çš„è¿½è¸ª

### æ—ç™½
```
Time Machine çš„åº”ç”¨åœºæ™¯éžå¸¸å¹¿æ³›ï¼š

- è°ƒè¯• Use-After-Free ç­‰å†…å­˜é—®é¢˜
- æ£€æµ‹å†…å­˜æ³„æ¼
- æ€§èƒ½åˆ†æžå’Œä¼˜åŒ–
- ç”Ÿäº§çŽ¯å¢ƒé—®é¢˜è¯Šæ–­

æ— éœ€ä¿®æ”¹ä»£ç ï¼Œæ— éœ€é‡æ–°ç¼–è¯‘ï¼Œ
åªéœ€è¦ä¸€ä¸ª PIDï¼Œå°±èƒ½å¼€å§‹è¿½è¸ªã€‚
```

### å­—å¹•
- "å¤šç§åº”ç”¨åœºæ™¯"
- "é›¶ä»£ç ä¿®æ”¹"
- "å³æ’å³ç”¨"

---

## ðŸŽ¬ åœºæ™¯ 7: æ€»ç»“å’Œå±•æœ› (4:50 - 5:00)

### ç”»é¢
- é¡¹ç›® logo
- GitHub é“¾æŽ¥
- å…³é”®ç‰¹æ€§åˆ—è¡¨

### ç‰¹æ€§åˆ—è¡¨
```
âœ… æ—¶é—´æ—…è¡Œè°ƒè¯•
âœ… è‡ªåŠ¨å´©æºƒæ£€æµ‹
âœ… å†…å­˜æ³„æ¼åˆ†æž
âœ… é›¶é…ç½®ä½¿ç”¨
âœ… ç”Ÿäº§çŽ¯å¢ƒå‹å¥½
âœ… å¼€æºå…è´¹
```

### æ—ç™½
```
eBPF Time Machine - è®©è°ƒè¯•åƒæ—¶é—´æ—…è¡Œä¸€æ ·ç®€å•ï¼

é¡¹ç›®ç‰¹ç‚¹ï¼š
- åˆ›æ–°çš„æ—¶é—´æ—…è¡Œè°ƒè¯•ä½“éªŒ
- åŸºäºŽ eBPF çš„é«˜æ€§èƒ½å®žçŽ°
- ç®€å•æ˜“ç”¨ï¼Œé›¶é…ç½®
- å®Œæ•´çš„æ–‡æ¡£å’Œç¤ºä¾‹
- å¼€æºï¼Œæ¬¢è¿Žè´¡çŒ®

æœªæ¥æˆ‘ä»¬è®¡åˆ’ï¼š
- æ·»åŠ  Web UI å¯è§†åŒ–
- é›†æˆ Cilium ç½‘ç»œè¿½è¸ª
- æ”¯æŒåˆ†å¸ƒå¼è¿½è¸ª
- AI è¾…åŠ©åˆ†æž

é¡¹ç›®å·²å¼€æºï¼Œæ¬¢è¿Žè®¿é—® GitHubï¼

æ„Ÿè°¢è§‚çœ‹ï¼
```

### å­—å¹•
- "eBPF Time Machine"
- "github.com/your-username/ebpf-time-machine"
- "è®©è°ƒè¯•åƒæ—¶é—´æ—…è¡Œä¸€æ ·ç®€å•ï¼â°âœ¨"

---

## ðŸ“ æ‹æ‘„æ³¨æ„äº‹é¡¹

### æŠ€æœ¯è¦æ±‚
- åˆ†è¾¨çŽ‡ï¼š1920x1080
- å¸§çŽ‡ï¼š30fps
- éŸ³é¢‘ï¼šæ¸…æ™°çš„æ—ç™½
- å­—å¹•ï¼šä¸­è‹±æ–‡åŒè¯­

### è§†è§‰æ•ˆæžœ
- ä½¿ç”¨ç»ˆç«¯å½•åˆ¶å·¥å…·ï¼ˆasciinemaï¼‰
- ä»£ç é«˜äº®
- å…³é”®ä¿¡æ¯é«˜äº®æ ‡æ³¨
- æµç•…çš„åœºæ™¯åˆ‡æ¢

### éŸ³é¢‘
- æ¸…æ™°çš„æ—ç™½
- é€‚å½“çš„èƒŒæ™¯éŸ³ä¹
- éŸ³æ•ˆï¼ˆå¯é€‰ï¼‰

### å­—å¹•
- å…³é”®æœ¯è¯­
- é‡è¦ä¿¡æ¯
- å‘½ä»¤å’Œè¾“å‡º

---

## ðŸŽ¯ æ¼”ç¤ºç›®æ ‡

1. **å¸å¼•æ³¨æ„**ï¼šå¼€åœº 30 ç§’æŠ“ä½è§‚ä¼—
2. **å±•ç¤ºé—®é¢˜**ï¼šè®©è§‚ä¼—äº§ç”Ÿå…±é¸£
3. **æ¼”ç¤ºè§£å†³æ–¹æ¡ˆ**ï¼šæ¸…æ™°å±•ç¤ºåŠŸèƒ½
4. **æŠ€æœ¯æ·±åº¦**ï¼šå±•ç¤ºæŠ€æœ¯å®žåŠ›
5. **åº”ç”¨ä»·å€¼**ï¼šè¯´æ˜Žå®žç”¨æ€§
6. **è¡ŒåŠ¨å·å¬**ï¼šå¼•å¯¼è®¿é—®é¡¹ç›®

---

**é¢„è®¡æ•ˆæžœ**ï¼š
- æ¸…æ™°å±•ç¤ºé¡¹ç›®ä»·å€¼
- æŠ€æœ¯å®žåŠ›å¾—åˆ°è®¤å¯
- å¸å¼•æ›´å¤šå…³æ³¨å’Œè´¡çŒ®

**æˆåŠŸæŒ‡æ ‡**ï¼š
- è§‚ä¼—èƒ½ç†è§£é¡¹ç›®ç”¨é€”
- è§‚ä¼—æƒ³è¦å°è¯•ä½¿ç”¨
- è¯„å§”è®¤å¯æŠ€æœ¯åˆ›æ–°

---

ç¥æ¼”ç¤ºæˆåŠŸï¼â°âœ¨
